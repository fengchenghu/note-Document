### kubernetes apiserver 地址
- http://10.136.196.126:3218  			 		集群1			207
- http://10.128.226.81:3218      				集群3			99
- http://10.128.227.209:3218					集群4			89++
- http://10.126.73.153:3218						集群5					
- http://10.162.0.14:3218					  	开发环境		132
- http://192.168.183.169:3218			test	测试环境		17

http://bjdhj-183-171.58os.org:31899/pro/docnum?appid=${appId}&version=${version}	数据库填写索引量查询URL

### 公司镜像仓库的账号密码  测试环境相同
	fengchenghu		：   	Fch1661567539
	搜索工具平台   http://tool.platform.search.58corp.com/utp/index.html   fengchenghu   1661567539
### Hadoop集群权限，hive表地址，HDFS使用
	kinit fengchenghu@58OS.ORG    输入Kerberos密码  Kerberos票据12小时有效
	ssh hdp_teu_search@10.126.81.137   进入Hadoop集群
jdbc连接hive表：	
	driverName = "org.apache.hive.jdbc.HiveDriver";
	url = "jdbc:hive2://hiveserver.58dns.org:10000/";
	user = "hdp_teu_search";
	password = "";
WebHdfs 使用： 上传文件需申请指定目录权限
    webhdfs:http://webhdfs.58corp.com/webhdfs/v1/路径?op=操作&user.name=hdp_teu_search


select appid,count(*) from wcserrorquery where day='2019-08-20' group by appid;

select b.* from (select appid, query, reason, cnt, row_number() over (partition by appid order by cnt desc)rank from (select appid, query, reason, count(*) as cnt from wcserrorquery where day='2019-08-20' group by appid,query,reason)a)b where b.rank<=300;

	
### 数据库账号密码
	开发环境新数据库：
		mysql -htest1255.db.58dns.org -P4192 -uwcs_test -p24336a5375c0f35c db58_wcs -A -N    	
		jdbc.driver=com.mysql.jdbc.Driver
        jdbc.url=jdbc:mysql://test1255.db.58dns.org:4192/db58_wcs?characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull&useSSL=false
        jdbc.username=wcs_test
        jdbc.password=24336a5375c0f35c
	线上二期新
		mysql -hwcs-mana.db.58dns.org -P4486 -uwcs_wr -p04e861487f82823d db58_wcs -A -N    		
		jdbc.driver=com.mysql.jdbc.Driver
        jdbc.url=jdbc:mysql://wcs-mana.db.58dns.org:4486/db58_wcs?characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull&useSSL=false
        jdbc.username=wcs_wr
        jdbc.password=04e861487f82823d
	
	测试环境 二期：	web 页面  线下新
		test1285.db.58dns.org:23322
		username : wcs_wr
		password : 04e861487f82823d
		db : db58_db58_wcs_v2_test
	测试环境 三期：web  页面  线下新v3
		test1255.db.58dns.org:4192
		username : wcsoffline_wr
		password : 3bce29ff6a45c7bc
		db : db58_wcs_offline
		
	kafka：  10.136.196.194  10.136.196.196   10.136.196.198   /opt/esearch/kafka_cluster/kafka

### 索引量查询URL
	开发环境： 	http://tjtx-88-132.58os.org:31890/pro/docnum?appid=1110811764351610882&version=2
	测试环境：	http://bjdhj-183-176.58os.org:31890/pro/docnum?appid=1042305639562371072&version=2
	集群1：		http://tjtx136-196-18.58os.org:31899/pro/docnum?appid=1011090085925376001&version=2
	集群2：		http://tjtx-87-195.58os.org:31899/pro/docnum?appid=1016521496736067584&version=2
	集群3：		http://tjtx148-7-143.58os.org:31899/pro/docnum?appid=1058192352268541952&version=2
	集群4：		http://tjtx-91-2.58os.org:31899/pro/docnum?appid=1121255468094775296&version=2

### wcs_app_monitor SCF key
	+FNe/mLhrVVT4SXXGGpFlO7jzWYEr6vf
	预热APP
		1094785871216947200		
		1094852006918537216
		1121304974534430721
		1162245176802988034 
	fengchenghu01,caoliuming,liyang77,huanglei02,yangchao10,zhangwenfeng,luke,wangyu67
    yanlijie
    zhuhongqian
### BSP 系统配置文件

文件名： app.properties 
appsecret=811a7e0bd91140a0e3579a5b7c6041c3
loginurl=http\://union.vip.58.com/
appkey=searchwcs
host=http\://cpcgi.web.58dns.org


###微信报警相关
	public static String token = "f683dd25dbb4c9200fcc418a6a4bb24f";	
    public static String template_id = "nOxU_E0-78wgeQTTtSJeih-stS4i9zMXc4r2yr4eL60";
    public static String wechaturl = "http://weixin.op.58dns.org/api/wechat_interface_api/send_template_message/";
	
	白名单
	URL ： http://weixin.op.58dns.org/api/wechat_interface_api/send_template_message/
	10.126.123.220
	10.126.88.132
	10.126.121.164
	10.126.121.165
	10.126.121.162
	10.148.9.99
	10.244.3.4
	10.136.196.207

### 日志
	日志机器： 10.126.81.227			indexproxy日志：/data02/wcsindexproxy， queryproxy日志：/data02/wcsquerylog_v2
	各种日志的存放位置:
1. 路由Proxy（routeproxy）
	wcsrouteproxy-index-proxy		：	/opt/log/wcsproxy_indexproxy/route-index-proxy
	wcsrouteproxy-query-proxy		：	/opt/log/wcsproxy_queryproxy/route-query-proxy
2.	下沉Proxy			机器名字的目录下	不带route的的proxy为下沉proxy 各个版本命名不一致
	index-proxy-scf		：	/opt/log/indexproxy/tjtx-80-198.58os.org		
	query-proxy-scf		：	/opt/log/queryproxy/tjtx136-201-205.58os.org
3.	merger层	每个pod所在物理机的opt 日志 目录下 esearchk8sctl 下以pod 名字命名的文件夹下
	/opt/log/esearchk8sctl/appid996276588230246400-merger-deploy-2077399782-lrsw5/esearch/merger
4.	searcher层 	每个pod所在物理机的opt 日志 目录下 esearchk8sctl 下以pod 名字命名的文件夹下
	/opt/log/esearchk8sctl/appid996276588230246400-searcher-shard2-1546682174722-deplsfkd9/esearch/searcher
5.	build 构建索引相关		每个pod所在物理机的opt 日志 目录下 esearchk8sctl 下以pod 名字命名的文件夹下的build目录
	/opt/log/esearchk8sctl/appid996276588230246400-searcher-shard2-1546682174722-deplsfkd9/builder
6.	query日志
	日志机器 10.126.81.227 等  的 /data02/wcsquerylog_v2  软链接： /home/work/wcs_proxy_query_v2
	
	碰到CrashLoopBackOff  一直重启的容器  检查yaml文件是不是写错，或者某些需要的文件无法拉取
###
### 拥有权限的ip
	10.126.88.133,
	10.126.88.137,
	10.126.90.146,
	10.126.88.200,
	10.126.88.84,
	10.126.90.164,
	10.126.89.24,
	10.126.90.162,
	10.126.88.165,
	10.126.88.83,
	10.126.88.131,
	10.126.88.164,
	10.136.200.157,
	10.136.200.196,
	10.136.201.19,
	10.136.200.221,
	10.136.200.132,
	10.136.200.80,
	10.136.200.103,
	10.136.198.230,
	10.136.197.207,
	10.136.224.150,
	10.136.200.209,
	10.136.200.77,
	10.136.198.207,
	10.136.219.206,
	10.136.198.205,
	10.136.197.210,
	10.136.200.79,
	10.136.198.156,
	10.136.200.208,
	10.136.200.223,
	10.136.219.207,
	10.136.200.230,
	10.136.201.3,
	10.136.200.130,
	10.136.219.208,
	10.136.219.231,
	10.136.200.205,
	10.136.201.2,
	10.136.200.207,
	10.136.201.27,
	10.136.201.20,
	10.136.219.209,
	10.136.200.97,
	10.136.200.102,
	10.136.199.29,
	10.136.200.144,
	10.136.200.149,
	10.136.200.200,
	10.136.200.158,
	10.136.200.195,
	10.136.200.155,
	10.136.219.230,
	10.136.198.209,
	10.136.197.209,
	10.136.199.2,
	10.136.199.138,
	10.136.199.4,
	10.136.200.78,
	10.136.200.206,
	10.136.201.28,
	10.136.201.26,
	10.136.200.81,
	10.136.200.96,
	10.136.200.143,
	10.136.199.30,
	10.136.219.205,
	10.136.200.70,
	10.136.198.208,
	10.136.198.158,
	10.136.201.4,
	10.136.199.28,
	10.136.200.156,
	10.136.200.154,
	10.136.199.27,
	10.136.200.131,
	10.136.200.220,
	10.136.200.30,
	10.136.199.26,
	10.136.198.206,
	10.136.200.199,
	10.136.224.152,
	10.136.199.3,
	10.136.200.198,
	10.136.200.197,
	10.136.198.231,
	10.136.200.231
	
测试环境：
	192.168.183.171
	192.168.183.68
	192.168.183.175
	192.168.183.52
	192.168.183.174
	
	192.168.183.176,
	10.9.194.11,
	192.168.66.224,
	192.168.66.193,
	192.168.67.173,
	192.168.188.201,
	192.168.185.61,
	192.168.187.17,
	192.168.67.213,
	192.168.185.174,
	192.168.183.220
	
	
	192.168.187.17   测试环境打镜像  执行yaml文件
	
	
	
	
	
	
### 线上环境和开发环境 etcd view  merger_svc/searcher.json指向的是 所有searcher的ip ：20022   

```	1004238214422102020	集群1 
		{
			"Searchers":[
				{
					"Searcher_List":[//第一个shard 的三个副本
						{
							"Ip":"10.244.130.13",
							"Port":"20022"
						},
						{
							"Ip":"10.244.2.13",
							"Port":"20022"
						},
						{
							"Ip":"10.244.3.13",
							"Port":"20022"
						}
					],
					"PartitionId":"0"
				},
				{
					"Searcher_List":[//第二个shard 的三个副本
						{
							"Ip":"10.244.17.26",
							"Port":"20022"
						},
						{
							"Ip":"10.244.29.22",
							"Port":"20022"
						},
						{
							"Ip":"10.244.61.4",
							"Port":"20022"
						}
					],
					"PartitionId":"1"
				},
				{
					"Searcher_List":[// 第三个 shard 的三个副本
						{
							"Ip":"10.244.102.2",
							"Port":"20022"
						},
						{
							"Ip":"10.244.126.2",
							"Port":"20022"
						},
						{
							"Ip":"10.244.13.17",
							"Port":"20022"
						}
					],
					"PartitionId":"2"
				}
			],
			"Idle_Check_Span":5000,
			"FastReturnPolicy":{
				"TimeoutRatio":2,
				"PartitionRatio":1,
				"MinTimeAllowed":30
			},
			"Fail_Check_Span":20000,
			"Fail_Ratio":0.55,
			"PartialResult_TimeRatio":0.7
		}
```

### 测试环境指向不知道什么， 查询正常   并且只有一个版本一个分片两副本 但此时有两个版本  

```1042354838316277760  wcs-test

		appid1042354838316277760-merger-deploy-549687c49d-29w8k           2/2       Unknown    0          1d        10.244.1.20       bjdhj-183-175.58os.org
		appid1042354838316277760-merger-deploy-549687c49d-bll99           2/2       Running    0          22h       10.244.0.80       bjdhj-183-171.58os.org
		appid1042354838316277760-searcher-shard0-1551780084576-dep5gxmb   3/3       Running    0          1d        10.244.0.45       bjdhj-183-171.58os.org
		appid1042354838316277760-searcher-shard0-1551780084576-deppvndj   3/3       Running    0          1d        10.244.2.49       bjdhj-183-174.58os.org
		
		appid1042354838316277760-searcher-shard0-deploy-7c45855cb6f97cd   3/3       Running    0          1d        10.244.0.75       bjdhj-183-171.58os.org

		{
			"Searchers":[
				{
					"PartitionId":"0",
					"Searcher_List":[	没有这个ip  
						{
							"Ip":"10.111.76.214",
							"Port":"20022"
						},
						{
							"Ip":"10.111.76.214",
							"Port":"20022"
						},
						{
							"Ip":"10.111.76.214",
							"Port":"20022"
						}
					]
				}
			],
			"Fail_Check_Span":20000,
			"Fail_Ratio":0.55,
			"PartialResult_TimeRatio":0.7
		}
```

routeProxy --->  sinkProxy  ---> merger  ---> searcher  



	